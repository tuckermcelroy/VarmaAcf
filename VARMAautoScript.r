#####################################
#### Test code for VARMA auto project

## wipe
rm(list=ls())

library(devtools)
library(Rcpp)
library(tictoc)

source_url("https://raw.githubusercontent.com/tuckermcelroy/VarmaAcf/main/autoVARMA.r")
source_url("https://raw.githubusercontent.com/tuckermcelroy/VarmaAcf/main/VARMAauto.r")
source_url("https://raw.githubusercontent.com/tuckermcelroy/VarmaAcf/main/var2.pre2par.r")
 
# set your directory and download cpp files
setwd("C:\\Users\\neide\\Documents\\GitHub\\VarmaAcf")

sourceCpp('VARMAauto.cpp')
sourceCpp('autoVARMA.cpp')

### Set up SVAR process

N <- 7
p <- 6
season <- 52
stretch <- c(rep(0,season-1),1)
q <- 0
psi <- c(0.190405265903077, -0.262459649086039, 0.780110791883975, -1.73988463808833, 
         2.92549101336382, -1.06264072405618, -1.20685276069824, 0.735895847107177, 
         -0.635030522001557, 0.00292701955400684, -2.6057154477403, 2.17749782520038, 
         0.935848809814464, 1.91493343803782, -0.222039800987726, 0.882953092833769, 
         0.761007155859821, 1.59802806299947, 0.615256900409681, -0.321009630551405, 
         1.05713868515584, 0.141163716858375, -1.02049911880382, 1.40614522802955, 
         -0.692027467665055, 0.353056833013007, 0.377615151331929, -0.265070532772244, 
         0.0257603393291533, 0.813809469684137, -0.585659897943619, -0.816398180131751, 
         -0.132402805465947, -1.17804327870815, 0.646111225770588, 0.865449721287017, 
         -1.16934341553619, -0.716057028999836, 1.6962819783143, -1.08817454238657, 
         -1.00713581139531, 2.49585209004563, -1.30027552442508, -1.46371543498106, 
         1.37102619765245, -1.09135497264338, -0.533094310852381, 0.399743472357385, 
         -0.00454245237822436, -0.202695641240038, -0.343632023688471, 
         0.866492203596971, 1.18522624988072, 1.50243886408393, 0.0662687975164629, 
         -0.0796963645655686, 1.39872456174277, -1.72507217571107, 0.495121855593256, 
         -0.0498793124861915, 0.642610631084139, 0.885545321260139, -0.938529427890889, 
         -0.14904682119676, 0.416759857100237, -0.358139590989452, 0.27911036006328, 
         0.111110737469944, -0.239427939290743, -0.874286968747366, 1.28885868510676, 
         -0.58597994707619, -0.826860257715067, -0.211207358691184, 1.09255510372121, 
         0.416047002455953, 2.3902394751179, 0.112300971265777, -0.524591348757094, 
         -0.17530992500998, 0.447428148693793, 0.368218265311938, 0.480057215084367, 
         0.316756568933361, -0.0267094334228433, 0.085876135315157, 2.42788869254669, 
         -1.81099531132421, -0.877785614206264, 0.543886821536885, -0.0397624371076089, 
         0.695715980655289, -1.1792619094557, 0.600534363956304, 0.545571178951308, 
         1.00057085749162, 0.519238625792191, 1.53141475613167, -0.57162110071492, 
         0.841214866985088, 0.719713377243948, 0.00250953966397317, -0.612995367924329, 
         0.177419229483024, 0.733853811900261, -0.225198839257054, 0.0912756025577613, 
         -0.228220523369676, -1.00381590202982, 0.844730012328381, -2.43561238993381, 
         0.53149791917444, -0.0105722400603786, 0.933161132211114, 0.105681025041923, 
         0.437064824989179, -0.849481737242763, 0.0902655060186511, -0.49116104144282, 
         -0.714779357951562, 0.318961419924475, 0.861181834658428, 2.19920983751672, 
         -0.120402299259241, -0.689619114791519, 1.03893465789617, 0.0408149348202562, 
         -0.397032782603873, 0.661664462172863, 0.12922050013831, 0.772780168057925, 
         -0.19113946152335, 1.63564877883705, 2.11601854207674, 0.664044791535652, 
         -0.748184538156702, 1.52102676752252, -0.407798439399452, 0.807959444212733, 
         1.01466127837085, -1.42683303607212, -1.23900776146835, 0.0621899245895722, 
         -0.654966534317395, 1.65288793054745, 0.602479967521587, 0.318013347249908, 
         -0.57930895316385, 0.889329298890547, 0.337727675031659, 0.00564314234716743, 
         0.697647489451391, 0.225061621164199, 1.75866824994915, 0.902541298807699, 
         -1.13323503245286, 0.0538617658119685, -0.129875461589849, -1.38391132383763, 
         1.01902008337094, 2.2037350377997, -0.769062114844334, -1.00871325787833, 
         0.331097815829929, -0.359919865489338, -0.378587751734491, 0.20636611516889, 
         -1.60864271528797, -0.66704080867414, 0.245546999108274, 0.323152395584275, 
         -1.70338042696535, 0.296383129646, 1.32538400855346, 1.32246512704553, 
         1.10607691564131, 1.00049409165016, -0.786428293365404, 1.27854314568677, 
         1.28502836667005, 0.691334397727116, -0.536189351239562, 0.853070059634231, 
         0.0255239948550041, -1.27397170735328, 1.56353205879848, -0.130961336605419, 
         0.0842944522658064, 0.848926402225816, -0.439442324010974, 1.01078128541859, 
         -0.388145449287232, 1.95680634411433, 0.447019617651242, -3.61790354329338, 
         -0.189691031767342, -0.162564450406215, -0.295473938001921, 1.57274035974559, 
         0.165741932885472, 1.28304350539385, 0.291688088125736, -2.20506547896126, 
         -0.0938682269783964, 0.0872804429419228, -0.383301751525736, 
         0.40075707567245, -0.272580203386791, 0.333719528835844, -1.29605295924088, 
         0.0234679512464684, 0.88928119796068, -0.556985191900709, -1.36364165026833, 
         -1.05702940826745, 0.747253013355881, 0.480818533600373, 0.883451974127227, 
         0.178389884228987, -0.474993414180021, -0.246180621516345, -0.43612065040327, 
         0.976096451201441, 0.746539117982941, 0.0871782473820377, -1.66879676636166, 
         0.921493874140028, -1.36181842666087, 0.200994544438125, -0.809952428498973, 
         0.425372169816399, -2.11518241438989, -0.273035255325539, 0.997744767551754, 
         -1.3415682539044, 0.441427974837766, 1.98191970405392, 0.119943187035441, 
         0.322758328997089, 0.0422208751033532, -1.18413172726843, 0.803661908492644, 
         0.748352119472393, -0.961026017028511, -1.42460378758568, 1.26653563952083, 
         -0.879468311369964, 0.329806970189793, -1.33171398711339, -2.01253586141549, 
         -1.05734154334082, -0.550640124999273, -1.18687413491598, -0.0356416852906856, 
         -1.04910842946455, 0.83753823957891, -0.091155988622209, 1.55789584574885, 
         0.087417525297669, -0.431234408837091, -1.44718767795689, 0.223876735678366, 
         1.94921188807896, -0.370673700805824, 0.480280953696004, -0.174193351324193, 
         1.53775494367787, -0.520969132359025, 0.803165579404603, -2.71358668882403, 
         -0.809226577011945, 0.41834607971414, 0.861270406552214, -1.02627650890411, 
         0.956576918185953, 1.44455845136842, 1.6939443654039, 0.562129990334171, 
         1.09711774777326, -1.18500769981403, -1.98451844580519, 0.208249009990251, 
         1.18201155832815, -0.24936042423644, 0.503839441804779, 1.31871630056608, 
         0.00792763818027753, -0.956279822183294, 1.1712555140043, 1.42815258987575, 
         0.830636080320593, 0.942493847663495, -0.940439438591323, 0.556176518962727
)
phi <- var2.pre2par(psi,p,N)
phiseas <- array(t(stretch) %x% phi,c(N,N,season*p))
phiseas <- array(cbind(diag(N),-1*matrix(phiseas,nrow=N)),c(N,N,season*p+1))
theta <- NULL
sigma <- diag(N)
param <- cbind(matrix(-1*phiseas[,,-1],nrow=N),sigma)


### Compute acf via four methods, lags 0 to 20

tic()
method1 <- VARMAauto(-1*phiseas[,,-1],theta,sigma,20)
toc()

tic()
method2 <- VARMA_auto(param,p*season,0,20)
toc()

tic()
method3 <- autoVARMA(NULL,NULL,phi,NULL,sigma,season,2000,20)
toc()

tic()
method4 <- auto_VARMA(cbind(matrix(phi,nrow=N),sigma),0,0,p,0,season,2000,20)
toc()



